<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Test de Preferencias - MotoMatch</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Modificar el orden de carga de scripts -->
  <script>
    // Función para cargar scripts secuencialmente con reintento
    function loadScriptsSequentially(scripts, callback, attempt = 1) {
      if (scripts.length === 0) {
        if (callback) callback();
        return;
      }
      
      var script = document.createElement('script');
      script.src = scripts[0] + "?v=" + Date.now(); // Evitar caché
      
      script.onload = function() {
        console.log('Script cargado exitosamente: ' + scripts[0]);
        // Cargar el siguiente script
        loadScriptsSequentially(scripts.slice(1), callback);
      };
      
      script.onerror = function() {
        console.error('Error al cargar: ' + scripts[0] + ', intento: ' + attempt);
        if (attempt < 3) {
          // Reintentar hasta 3 veces con delay incremental
          setTimeout(() => {
            loadScriptsSequentially(scripts, callback, attempt + 1);
          }, attempt * 1000);
        } else {
          // Después de 3 intentos fallidos, continuar con el siguiente script
          console.error('Error fatal al cargar ' + scripts[0] + ' después de 3 intentos');
          loadScriptsSequentially(scripts.slice(1), callback);
        }
      };
      
      document.head.appendChild(script);
    }
    
    // Al cargar el documento, cargamos todos los scripts en orden
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM cargado, cargando scripts...');
      // IMPORTANTE: Asegurarse de que magnetic-bubbles.js se cargue PRIMERO
      var scripts = [
        "{{ url_for('static', filename='js/magnetic-bubbles.js') }}",
        "{{ url_for('static', filename='js/debug-panel.js') }}",
        "{{ url_for('static', filename='js/bubbles-recovery.js') }}",
        "{{ url_for('static', filename='js/test.js') }}",
        "{{ url_for('static', filename='js/test_finalizacion.js') }}"
      ];
      
      // Cargar scripts en orden y luego inicializar con verificaciones adicionales
      loadScriptsSequentially(scripts, function() {
        console.log('Todos los scripts cargados, verificando MagneticBubbles...');
        
        // Verificar que MagneticBubbles está disponible
        if (typeof window.MagneticBubbles !== 'function') {
          console.error('MagneticBubbles no está disponible después de cargar scripts. Intentando recuperar...');
          // Cargar magnetic-bubbles.js directamente
          var scriptEmergencia = document.createElement('script');
          scriptEmergencia.src = "{{ url_for('static', filename='js/magnetic-bubbles.js') }}?emergency=" + Date.now();
          scriptEmergencia.onload = function() {
            console.log('Script de emergencia MagneticBubbles cargado. Reintentando inicialización...');
            if (typeof window.initializeTest === 'function') {
              setTimeout(window.initializeTest, 100);
            } else if (typeof window.recuperarTest === 'function') {
              setTimeout(window.recuperarTest, 100);
            }
          };
          document.head.appendChild(scriptEmergencia);
          return;
        }
        
        // Inicializar test si la función está disponible
        if (typeof window.initializeTest === 'function') {
          console.log('Función initializeTest encontrada, inicializando...');
          setTimeout(window.initializeTest, 100);
        } else {
          console.error('Error: La función initializeTest no está disponible');
          // Intentar método de recuperación
          if (typeof window.recuperarTest === 'function') {
            console.log('Intentando recuperación de test...');
            setTimeout(window.recuperarTest, 100);
          } else {
            console.error('No hay método de recuperación disponible');
            alert('Error al inicializar el test. Por favor, recarga la página.');
          }
        }
      });
    });
  </script>
  
  <!-- Script para manejar errores y mostrar botón de reintentar -->
  <script>
    // Función para mostrar el botón de reintentar después de un tiempo
    function mostrarBotonReintentar() {
      setTimeout(function() {
        // Verificar si las burbujas se inicializaron correctamente
        var estilosCanvas = document.getElementById('estilos-canvas');
        var hayCanvas = estilosCanvas && estilosCanvas.querySelector('canvas');
        
        if (!hayCanvas) {
          console.error("No se detectó inicialización correcta, mostrando botón de reintentar");
          var retryButton = document.getElementById('retry-button');
          if (retryButton) {
            retryButton.style.display = 'block';
          }
        }
      }, 3000); // Esperar 3 segundos antes de mostrar el botón
    }
    
    // Registrar función para ejecutar después de cargar scripts
    document.addEventListener('DOMContentLoaded', function() {
      mostrarBotonReintentar();
    });
    
    // Función de verificación durante navegación
    function verificarIntegridadCanvas() {
      // Después de la navegación, verificar que los canvas estén intactos
      setTimeout(function() {
        const preguntaActiva = document.querySelector('.pregunta.active');
        if (preguntaActiva) {
          const id = preguntaActiva.id;
          console.log("Verificando integridad del canvas en: " + id);
          
          if (id === 'pregunta-1') {
            const estilosCanvas = document.getElementById('estilos-canvas');
            const hayCanvas = estilosCanvas && estilosCanvas.querySelector('canvas');
            if (!hayCanvas) {
              console.error("Canvas de estilos perdido después de navegación");
              if (typeof window.recuperarTest === 'function') {
                window.recuperarTest();
              }
            }
          } else if (id === 'pregunta-2') {
            const marcasCanvas = document.getElementById('marcas-canvas');
            const hayCanvas = marcasCanvas && marcasCanvas.querySelector('canvas');
            if (!hayCanvas) {
              console.error("Canvas de marcas perdido después de navegación");
              if (typeof window.recuperarTest === 'function') {
                window.recuperarTest();
              }
            }
          }
        }
      }, 200);
    }
    
    // Observar cambios de pregunta activa
    document.addEventListener('DOMContentLoaded', function() {
      // Configurar observer para detectar cambios en clases
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.type === 'attributes' && 
              mutation.attributeName === 'class' &&
              mutation.target.classList.contains('active')) {
            verificarIntegridadCanvas();
          }
        });
      });
      
      // Observar todas las preguntas para detectar cuando se activan
      const preguntas = document.querySelectorAll('.pregunta');
      preguntas.forEach(function(pregunta) {
        observer.observe(pregunta, { attributes: true });
      });
      
      // Configurar listeners para botones de navegación
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      
      if (prevBtn) {
        prevBtn.addEventListener('click', verificarIntegridadCanvas);
      }
      
      if (nextBtn) {
        nextBtn.addEventListener('click', verificarIntegridadCanvas);
      }
    });
  </script>
  <style>
    /* Ajustes específicos para canvas de burbujas - versión elegante */
    .circle-canvas {
      min-height: 400px;
      height: 50vh;
      border-radius: 12px;
      margin-bottom: 15px;
      position: relative;
      overflow: hidden;
      width: 100%;
      background: linear-gradient(to bottom, rgba(30, 30, 32, 0.95), rgba(24, 24, 26, 0.95));
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-sizing: border-box;
    }
    
    /* Asegurar que los canvas se rendericen correctamente */
    #estilos-canvas canvas, #marcas-canvas canvas {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 100% !important;
      height: 100% !important;
      touch-action: none;
    }
    
    /* Estilos para el botón de reintentar */
    .retry-button {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #f97316;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      font-size: 16px;
      z-index: 100;
    }
    
    .retry-button:hover {
      background-color: #ea580c;
    }
    
    .pregunta {
      display: none;
      background-color: rgba(0, 0, 0, 0.7);
      border-radius: 10px;
      padding: 25px;
      margin-bottom: 20px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      animation: fadeIn 0.5s ease;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .pregunta.active {
      display: block;
      opacity: 1;
    }
    
    .progress-container {      
      width: 100%;
      height: 8px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      margin-bottom: 20px;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      width: 0%;
      background-color: #f97316;
      transition: width 0.3s ease;
    }
    
    /* Animación para fadeIn */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .options-wrapper {
      width: 100%;
      height: 100%;
      padding: 0; /* Eliminamos el padding para que el canvas ocupe todo el espacio */
    }
    
    #physics-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }
    
    /* Estilos para asegurar que los canvas sean visibles y reciban eventos */
    #estilos-canvas, #marcas-canvas {
      width: 100% !important;
      height: 100% !important;
      pointer-events: auto;
      touch-action: none; /* Mejora interacción en dispositivos táctiles */
    }
    
    /* Estilos para asegurar que los canvas reciban los eventos del mouse */
    canvas {
      position: relative;
      z-index: 1;
    }
    
    /* Estilos para los círculos seleccionados */
    .circulo-seleccionado {
      filter: brightness(1.5);
      box-shadow: 0 0 15px #f97316;
    }
    
    /* Mejorar visibilidad de textos */
    h2 {
      color: #f97316;
      text-shadow: 0 0 2px rgba(0,0,0,0.5);
    }
    
    /* Estilo para ayudar a los usuarios a entender la interacción */
    .interaction-help {
      font-size: 14px;      
      font-style: italic;
      color: #f97316;
      margin-bottom: 10px;
    }

    /* Modal de finalización */
    .completion-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    .modal-content {
      background-color: rgba(0, 0, 0, 0.9);
      border: 2px solid #f97316;
      border-radius: 10px;
      padding: 30px;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 0 20px rgba(249, 115, 22, 0.5);
      animation: fadeIn 0.5s;
    }
    
    /* Estilos para los botones de navegación */
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    
    .nav-button {
      background-color: #f97316;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .nav-button:hover {
      background-color: #ea580c;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    .nav-button:disabled {
      background-color: #666;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    /* Efecto de confeti para la finalización */
    @keyframes confettiDrop {
      0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }
    
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: #f97316;
      border-radius: 50%;
      animation: confettiDrop 4s ease-in-out forwards;
      z-index: 1001;
    }
    
    /* Mejorar selectores */
    select {
      width: 100%;
      padding: 12px;
      border-radius: 5px;
      border: 1px solid #f97316;
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      margin-bottom: 15px;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    select:focus {
      outline: none;
      border-color: #ea580c;
      box-shadow: 0 0 8px rgba(249, 115, 22, 0.5);
    }
    
    option {
      background-color: #111;
      color: white;
    }
    
    .help-text {
      font-size: 14px;
      color: #aaa;
      font-style: italic;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <a href="{{ url_for('main.dashboard') }}" class="back-dashboard-btn">
    <i class="fas fa-arrow-left"></i> Regresar al Dashboard
  </a>
  
  <div id="physics-container"></div>
  <div id="contenedorPrincipalTest" class="main-container">
    <div class="test-container">
      <h1 class="tituloFriends">Test de Preferencias</h1>
      
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
        <!-- Pregunta 1: Estilo de moto -->
      <section class="pregunta active" id="pregunta-1" data-type="bubbles" data-key="estilos">
        <h2>1. ¿Qué estilo(s) de moto te gustan más?</h2>
        <p>Haz clic en las burbujas para seleccionar (1 clic: me gusta, 4 clics: me encanta)</p>
        <p class="interaction-help">Puedes hacer clic en cualquier parte para que las burbujas se muevan</p>
        <div class="options-wrapper">
          <div class="circle-canvas" id="estilos-canvas">
            <!-- Botón de reintentar en caso de error -->
            <button id="retry-button" class="retry-button" onclick="window.recuperarTest()">Error al cargar. Reintentar</button>
          </div>
        </div>
      </section>

      <!-- Pregunta 2: Marca favorita -->
      <section class="pregunta" id="pregunta-2" data-type="bubbles" data-key="marcas">
        <h2>2. ¿Qué marca(s) prefieres?</h2>
        <p>Haz clic en las burbujas para seleccionar (1 clic: me gusta, 4 clics: me encanta)</p>
        <p class="interaction-help">Puedes hacer clic en cualquier parte para que las burbujas se muevan</p>
        <div class="options-wrapper">
          <div class="circle-canvas" id="marcas-canvas">
            <!-- Botón de reintentar en caso de error -->
            <button id="retry-button-marcas" class="retry-button" onclick="window.recuperarTest()">Error al cargar. Reintentar</button>
          </div>
        </div>
      </section>
      
      <!-- Pregunta 3: Nivel de experiencia (determina peso y siguientes preguntas) -->
      <section class="pregunta" id="pregunta-3" data-type="select" data-key="experiencia" data-branch="true">
        <h2>3. ¿Cuál es tu nivel de experiencia?</h2>
        <select name="experiencia" id="experiencia">
          <option value="inexperto">Inexperto</option>
          <option value="experto">Muy Experto</option>
        </select>
        <p class="help-text">Esta respuesta determinará el tipo de preguntas que se te mostrarán a continuación</p>
      </section>

      <!-- RAMA INEXPERTO -->
      <!-- Pregunta 4-I: Uso (determina potencia) -->
      <section class="pregunta rama-inexperto" id="pregunta-4-inexperto" data-type="select" data-key="uso">
        <h2>4. ¿Qué uso le darás a la moto?</h2>
        <select name="uso" id="uso">
          <option value="ciudad">Uso en ciudad</option>
          <option value="paseo">Paseos ocasionales</option>
          <option value="viajes">Viajes largos</option>
          <option value="mixto">Uso mixto</option>
          <option value="no_se">No estoy seguro</option>
        </select>
      </section>

      <!-- Pregunta 5-I: Acompañantes (determina torque) -->
      <section class="pregunta rama-inexperto" id="pregunta-5-inexperto" data-type="select" data-key="acompanantes">
        <h2>5. ¿Viajarás con acompañantes, carga o solo?</h2>
        <select name="acompanantes" id="acompanantes">
          <option value="solo">Siempre solo</option>
          <option value="ocasional">Ocasionalmente con acompañante</option>
          <option value="frecuente">Frecuentemente con acompañante</option>
          <option value="carga">Con carga</option>
          <option value="no_se">No estoy seguro</option>
        </select>
      </section>

      <!-- Pregunta 6-I: Consumo vs Potencia (determina cilindrada) -->
      <section class="pregunta rama-inexperto" id="pregunta-6-inexperto" data-type="select" data-key="consumo">
        <h2>6. ¿Prefieres ahorrar gasolina o tener más potencia?</h2>
        <select name="consumo" id="consumo">
          <option value="ahorro">Priorizo el ahorro de combustible</option>
          <option value="equilibrio">Equilibrio entre consumo y potencia</option>
          <option value="potencia">Priorizo la potencia</option>
          <option value="no_se">No estoy seguro</option>
        </select>
      </section>

      <!-- Pregunta 7-I: Precio (determina precio) -->
      <section class="pregunta rama-inexperto" id="pregunta-7-inexperto" data-type="select" data-key="precio">
        <h2>7. ¿Tienes algún rango de precios?</h2>
        <select name="precio" id="precio-inexperto">
          <option value="bajo">Menos de Q30,000</option>
          <option value="medio_bajo">Q30,000 - Q50,000</option>
          <option value="medio">Q50,000 - Q80,000</option>
          <option value="alto">Más de Q80,000</option>
          <option value="no_se">No tengo un presupuesto definido</option>
        </select>
        <input type="number" name="presupuesto" id="presupuesto" value="8000" min="1000" max="50000" required>
      </section>

      <!-- RAMA EXPERTO -->
      <!-- Pregunta 4-E: Potencia -->
      <section class="pregunta rama-experto" id="pregunta-4-experto" data-type="select" data-key="potencia">
        <h2>4. ¿Qué rango de potencia buscas?</h2>
        <select name="potencia" id="potencia">
          <option value="baja">Baja potencia (menos de 35HP)</option>
          <option value="media_baja">Potencia media-baja (35-60HP)</option>
          <option value="media">Potencia media (60-90HP)</option>
          <option value="alta">Potencia alta (90-120HP)</option>
          <option value="muy_alta">Potencia muy alta (más de 120HP)</option>
          <option value="no_se">No tengo preferencia</option>
        </select>
      </section>

      <!-- Pregunta 5-E: Torque -->
      <section class="pregunta rama-experto" id="pregunta-5-experto" data-type="select" data-key="torque">
        <h2>5. ¿Qué rango de torque prefieres?</h2>
        <select name="torque" id="torque">
          <option value="bajo">Torque bajo (menos de 30Nm)</option>
          <option value="medio_bajo">Torque medio-bajo (30-50Nm)</option>
          <option value="medio">Torque medio (50-80Nm)</option>
          <option value="alto">Torque alto (80-120Nm)</option>
          <option value="muy_alto">Torque muy alto (más de 120Nm)</option>
          <option value="no_se">No tengo preferencia</option>
        </select>
      </section>

      <!-- Pregunta 6-E: Cilindrada -->
      <section class="pregunta rama-experto" id="pregunta-6-experto" data-type="select" data-key="cilindrada">
        <h2>6. ¿Qué cilindrada buscas?</h2>
        <select name="cilindrada" id="cilindrada">
          <option value="pequeña">Pequeña (menos de 250cc)</option>
          <option value="media_baja">Media-baja (250-400cc)</option>
          <option value="media">Media (400-650cc)</option>
          <option value="alta">Alta (650-900cc)</option>
          <option value="muy_alta">Muy alta (más de 900cc)</option>
          <option value="no_se">No tengo preferencia</option>
        </select>
      </section>

      <!-- Pregunta 7-E: Uso (igual que para inexpertos) -->
      <section class="pregunta rama-experto" id="pregunta-7-experto" data-type="select" data-key="uso_experto">
        <h2>7. ¿Qué uso le darás a la moto?</h2>
        <select name="uso_experto" id="uso_experto">
          <option value="ciudad">Uso en ciudad</option>
          <option value="paseo">Paseos ocasionales</option>
          <option value="viajes">Viajes largos</option>
          <option value="mixto">Uso mixto</option>
          <option value="no_se">No estoy seguro</option>
        </select>
      </section>

      <!-- Pregunta 8-E: Acompañantes (igual que para inexpertos) -->
      <section class="pregunta rama-experto" id="pregunta-8-experto" data-type="select" data-key="acompanantes_experto">
        <h2>8. ¿Viajarás con acompañantes, carga o solo?</h2>
        <select name="acompanantes_experto" id="acompanantes_experto">
          <option value="solo">Siempre solo</option>
          <option value="ocasional">Ocasionalmente con acompañante</option>
          <option value="frecuente">Frecuentemente con acompañante</option>
          <option value="carga">Con carga</option>
          <option value="no_se">No estoy seguro</option>
        </select>
      </section>

      <!-- Pregunta 9-E: Precio (determina precio) -->
      <section class="pregunta rama-experto" id="pregunta-9-experto" data-type="select" data-key="precio_experto">
        <h2>9. ¿Tienes algún rango de precios?</h2>
        <select name="precio_experto" id="precio-experto">
          <option value="bajo">Menos de Q30,000</option>
          <option value="medio_bajo">Q30,000 - Q50,000</option>
          <option value="medio">Q50,000 - Q80,000</option>
          <option value="alto">Q80,000 - Q120,000</option>
          <option value="muy_alta">Más de Q120,000</option>
          <option value="no_se">No tengo un presupuesto definido</option>
        </select>
      </section>

      <div class="nav-buttons">
        <button id="prev-btn" class="nav-button" disabled><i class="fas fa-arrow-left"></i> Anterior</button>
        <button id="next-btn" class="nav-button">Siguiente <i class="fas fa-arrow-right"></i></button>
      </div>
    </div>
  </div>

  <!-- Modal de finalización -->
  <div class="completion-modal" id="completion-modal">
    <div class="modal-content">
      <h2>¡Test completado con éxito!</h2>
      <p>Gracias por completar el test de preferencias. Con esta información podremos recomendarte las mejores motos que se ajusten a tus gustos.</p>
      <button id="finish-btn" class="nav-button" onclick="finalizarTest()">Ver mis recomendaciones</button>
    </div>
  </div>

  <script>
  // Función para finalizar el test y enviar datos a recomendaciones
  function finalizarTest(testData) {
    // Crear un formulario oculto para enviar los datos
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = "{{ url_for('main.guardar_test') }}";
    form.style.display = 'none';
    
    // Agregar los datos del test como campos ocultos
    for (const key in testData) {
      if (testData.hasOwnProperty(key)) {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = key;
        input.value = typeof testData[key] === 'object' ? 
          JSON.stringify(testData[key]) : testData[key];
        form.appendChild(input);
      }
    }
    
    // Enviar el formulario
    document.body.appendChild(form);
    console.log("Enviando datos del test:", testData);
    form.submit();
  }
    // Modificar el comportamiento del botón de finalización en el modal
  document.addEventListener('DOMContentLoaded', function() {
    // Buscar el botón de finalización en el modal
    const finishButton = document.querySelector('.completion-modal .modal-content button');
    
    if (finishButton) {
      finishButton.addEventListener('click', function() {
        // IMPORTANTE: Primero aseguramos que los datos de las burbujas se transfieran a testResults
        if (!window.testResults) {
          window.testResults = {};
        }
        
        // Asegurar que las selecciones de burbujas se transfieran a testResults
        window.testResults.estilos = window.respuestas ? window.respuestas.estilos : {};
        window.testResults.marcas = window.respuestas ? window.respuestas.marcas : {};
        
        // Recolectar todos los datos del test
        const testData = {
          // Datos básicos del test
          experiencia: window.testResults ? window.testResults.experiencia : 'intermedio',
          presupuesto: window.testResults ? window.testResults.presupuesto : '10000',
          uso: window.testResults ? window.testResults.uso : 'mixto',
          
          // Usar window.testResults para las selecciones de burbujas 
          estilos: window.testResults ? window.testResults.estilos : {},
          marcas: window.testResults ? window.testResults.marcas : {}
        };
        
        // Log para depuración
        console.log("Datos completos del test:", {
          ...testData,
          "Fuente estilos": window.respuestas ? "window.respuestas" : "vacío",
          "Contenido respuestas": window.respuestas
        });
        
        // Enviar los datos a la ruta de procesamiento
        finalizarTest(testData);
      });
    }
  });
</script>

  <!-- Asegúrate de que este código en recomendaciones.js procese todas las recomendaciones enviadas -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
        // Obtener datos de recomendaciones
        let motosRecomendadas = window.motosRecomendadas || [];
        
        // Limitaría a 4 si quisieras forzar ese número exacto
        // motosRecomendadas = motosRecomendadas.slice(0, 4);
        
        // Generar tarjetas para cada moto
        motosRecomendadas.forEach(moto => {
            // Código para generar las tarjetas HTML
        });
    });
  </script>

  <footer>
    <p>&copy; 2025 MotoMatch. Todos los derechos reservados. | <a href="/" class="link">Inicio</a></p>
  </footer>
</body>
</html>